let
  nixpkgs = fetchTarball "channel:nixos-24.11";
  pkgs = import nixpkgs {};
  lib = pkgs.lib;

  recipe = { python3, fetchurl }:
    python3.pkgs.buildPythonApplication rec {
      pname = "kittyai";
      version = "1.0.0";

      format = "pyproject";

      src = ./.;

      propagatedBuildInputs = with python3.pkgs; [
        openai
        python-dotenv
      ];

      nativeBuildInputs = with python3.pkgs; [
        setuptools
      ];

      meta = with lib; {
        homepage = "https://github.com/quarterstar/kittyai";
        description = "AI integration for Kitty terminal";
        license = licenses.mit;
        maintainers = with maintainers; [ quarterstar ];
      };

      dontUseSetuptoolsCheck = true;
    };

in pkgs.callPackage recipe {}
